__NUXT_JSONP__("/articles/spring-study-week7", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){return {data:[{article:{slug:"spring-study-week7",description:"코드가 푸시되면 자동으로 배포해보자",title:"Travis CI 배포 자동화",category:"Back-End",author:t,featured:"Featured",img:"spring.png",toc:[{id:u,depth:2,text:v},{id:w,depth:3,text:x}],body:{type:"root",children:[{type:b,tag:"h2",props:{id:u},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%EC%8A%A4%ED%94%84%EB%A7%81-%EC%8A%A4%ED%84%B0%EB%94%94-7%EC%A3%BC%EC%B0%A8%EC%B1%95%ED%84%B09",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:v}]},{type:a,value:c},{type:b,tag:"h3",props:{id:w},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#ci--cd-%EB%9E%80",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:x}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"CI(Continuous Integration-지속적 통합)은 코드 버전 관리를 하는 VCS 시스템(git, svn 등)에 PUSH가 되면 자동으로 테스트와 빌드가 수행되어 안정적인 배포 파일을 만드는 과정"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"CD(Continuous Deployment-지속적인 배포)은 이 빌드 경과를 자동으로 운영 서버에 무중단 배포까지 진행되는 과정"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:y,props:{id:"github와-travis-ci-연동"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#github%EC%99%80-travis-ci-%EC%97%B0%EB%8F%99",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"Github와 Travis CI 연동"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Travis CI는 깃허브에서 제공하는 무료 CI 서비스"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"젠킨스와 같은 CI 도구도 있지만, 젠킨스는 설치형이기 때문에 이를 위한 EC2 인스턴스가 하나 더 필요"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"프로젝트에 Travis CI(.travis.yml) 설정\n"},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Travis CI의 상세한 설정은 프로젝트에 존재하는 .travis.yml 파일 로 할 수 있습니다. build.gradle과 같은 위치에 해당 파일 생성"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Travis CI에 접속해서 깃허브 계정으로 로그인을 한 뒤, 왼쪽 위에 계정명 \u003E Setting 을 클릭, 그리고 해당 프로젝트를 활성화 시킨다\n* Travis CI Web Service 에서 Github 계정 로그인\n* Travis Settins 에서 연동할 Github repository 활성화"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"사진 수정하기!!!! "},{type:b,tag:"img",props:{alt:"데이터베이스 생성",src:"\u002Fspring-study-week5\u002Fdatabase.png"},children:[]}]},{type:a,value:c},{type:b,tag:y,props:{id:"프로젝트-설정"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A4%EC%A0%95",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"프로젝트 설정"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"travis.yml 추가\n"},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"build.gradle 동일한 위치에 추가"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[]}]}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"language: java\njdk: openjdk8"}]},{type:a,value:c},{type:b,tag:l,props:{id:"travis-ci-를-어느-branch-가-push-될-때-수행할지-설정"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#travis-ci-%EB%A5%BC-%EC%96%B4%EB%8A%90-branch-%EA%B0%80-push-%EB%90%A0-%EB%95%8C-%EC%88%98%ED%96%89%ED%95%A0%EC%A7%80-%EC%84%A4%EC%A0%95",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"Travis CI 를 어느 branch 가 push 될 때 수행할지 설정"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"branches:\nonly: master"}]},{type:a,value:c},{type:b,tag:l,props:{id:"gradle-통해-의존서을-받게-되면-해당-디렉토리에-cache-하여"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#gradle-%ED%86%B5%ED%95%B4-%EC%9D%98%EC%A1%B4%EC%84%9C%EC%9D%84-%EB%B0%9B%EA%B2%8C-%EB%90%98%EB%A9%B4-%ED%95%B4%EB%8B%B9-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC%EC%97%90-cache-%ED%95%98%EC%97%AC",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"gradle 통해 의존서을 받게 되면 해당 디렉토리에 cache 하여,"}]},{type:a,value:c},{type:b,tag:l,props:{id:"같은-의존성은-다음-배포-때부터-받지-않도록-설정"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%EA%B0%99%EC%9D%80-%EC%9D%98%EC%A1%B4%EC%84%B1%EC%9D%80-%EB%8B%A4%EC%9D%8C-%EB%B0%B0%ED%8F%AC-%EB%95%8C%EB%B6%80%ED%84%B0-%EB%B0%9B%EC%A7%80-%EC%95%8A%EB%8F%84%EB%A1%9D-%EC%84%A4%EC%A0%95",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"같은 의존성은 다음 배포 때부터 받지 않도록 설정"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"cache:\ndirectories:"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"'$HOME\u002F.m2\u002Frepository'"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"'$HOME\u002F.gradle'"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:z}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:A}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:l,props:{id:"branch-에-push-되었을-때-수행하는-명령어"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#branch-%EC%97%90-push-%EB%90%98%EC%97%88%EC%9D%84-%EB%95%8C-%EC%88%98%ED%96%89%ED%95%98%EB%8A%94-%EB%AA%85%EB%A0%B9%EC%96%B4",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"branch 에 push 되었을 때 수행하는 명령어"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:B}]},{type:a,value:c},{type:b,tag:l,props:{id:"travis-ci-실행-완료-후-자동-알림-설정"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#travis-ci-%EC%8B%A4%ED%96%89-%EC%99%84%EB%A3%8C-%ED%9B%84-%EC%9E%90%EB%8F%99-%EC%95%8C%EB%A6%BC-%EC%84%A4%EC%A0%95",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"Travis CI 실행 완료 후 자동 알림 설정"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"notifications:\nemail:\nrecipients:\n- [메일 주소]"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"* **Travis CI + AWS S3 연동**\n* AWS S3는 일종의 파일 서버d\n* 정적 파일이나 배포 파일들을 관리하는 기능을 지원하며, 보통 이미지 업로드를 구현한다면 이 S3를 이용하여 구현하는 경우가 많음\n\n![전체적인 구조](\u002Fspring-study-week6\u002F01.png)\n\n* IAM 사용자 만들기\n* 사용자 세부 정보 설정\n* 사용자 이름 \u003E jimmyberg-travis-deploy\n* AWS 액세스 유형 선택 \u003E 프로그래밍 방식 액세스\n* 권한 설정 및 기존 정책 직접 연결\n* AmazonS3FullAccess, AmazonCodeDeployFullAccess 태그 추가\n* 키 : Name, 값 : jimmyberg-travis-deploy\n\n* Travis CI에 S3 액세스 키 등록\n* 연동한 repository 의 settings 에서 키 등록\n* AWS_ACCESS_KEY(액세스 키)\n* AWS_SECRET_KEY(비밀 액세스 키)\n* .travis.yml 에서 $AWS_ACCESS_KEY, $AWS_SECRET_KEY 으로 사용\n\n\n\n* **S3 버킷 생성**\n\n* 버킷 이름 \u003E spring-study\n* .travis.yml 수정\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"...\nscript: \".\u002Fgradlew clean build\""}]},{type:a,value:c},{type:b,tag:l,props:{id:"수정-start"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%EC%88%98%EC%A0%95-start",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"수정 start"}]},{type:a,value:c},{type:b,tag:l,props:{id:"deploy-가-실행되기-전에-수행"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#deploy-%EA%B0%80-%EC%8B%A4%ED%96%89%EB%90%98%EA%B8%B0-%EC%A0%84%EC%97%90-%EC%88%98%ED%96%89",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"deploy 가 실행되기 전에 수행"}]},{type:a,value:c},{type:b,tag:l,props:{id:"codedeploy-는-jar-파일-인식하지-못하므로"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#codedeploy-%EB%8A%94-jar-%ED%8C%8C%EC%9D%BC-%EC%9D%B8%EC%8B%9D%ED%95%98%EC%A7%80-%EB%AA%BB%ED%95%98%EB%AF%80%EB%A1%9C",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"CodeDeploy 는 Jar 파일 인식하지 못하므로"}]},{type:a,value:c},{type:b,tag:l,props:{id:"프로젝트를-압축한-zip-파일로-전달"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EB%A5%BC-%EC%95%95%EC%B6%95%ED%95%9C-zip-%ED%8C%8C%EC%9D%BC%EB%A1%9C-%EC%A0%84%EB%8B%AC",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"프로젝트를 압축한 zip 파일로 전달"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:C}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"zip -r rest-api .\u002F*"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"mkdir -p deploy"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"mv rest-api.zip deploy\u002Frest-api.zip"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:l,props:{id:"외부-서비스와-연동될-명령어-정의"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%EC%99%B8%EB%B6%80-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%99%80-%EC%97%B0%EB%8F%99%EB%90%A0-%EB%AA%85%EB%A0%B9%EC%96%B4-%EC%A0%95%EC%9D%98",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"외부 서비스와 연동될 명령어 정의"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"deploy:\n- provider: s3\naccess_key_id: $AWS_ACCESS_KEY\nsecret_access_key: $AWS_SECRET_KEY"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"  bucket: spring-study\n  region: ap-northeast-2\n  skip_cleanup: true\n  acl: private\n  local_dir: deploy     # 지정한 위치의 파일들만 S3로 전송\n  wait_until_deployed: true\n"}]}]}]},{type:a,value:c},{type:b,tag:l,props:{id:"수정-end"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%EC%88%98%EC%A0%95-end",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"수정 end"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"notifications:\n..."}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"![모든 퍼블릭 엑세스 차단](\u002Fspring-study-week6\u002F03.png)\n\n\n![S3 버킷 생성 완료](\u002Fspring-study-week6\u002F02.png)\n\n\n* **Travis CI, S3, CodeDeploy 연동**\n* EC2 에 IAM 역할 추가\n      * EC2 \u003E 인스턴스 설정 \u003E IAM 역할 연결\u002F바꾸기\n      * ec2-codedeploy-role 역할 선택\n      * EC2 인스턴스 재부팅\n* EC2 에 CodeDeploy agent 설치\n\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"$ aws s3 cp s3:\u002F\u002Faws-codedeploy-ap-northeast-2\u002Flatest\u002Finstall .\u002Fs3 --resion ap-northeast-2"}]},{type:a,value:c},{type:b,tag:l,props:{id:"설치-디렉토리-이동"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%EC%84%A4%EC%B9%98-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC-%EC%9D%B4%EB%8F%99",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"설치 디렉토리 이동"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"$ cd s3"}]},{type:a,value:c},{type:b,tag:l,props:{id:"실행-권한-추가"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%EC%8B%A4%ED%96%89-%EA%B6%8C%ED%95%9C-%EC%B6%94%EA%B0%80",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"실행 권한 추가"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"$ chmod +x .\u002Finstall"}]},{type:a,value:c},{type:b,tag:l,props:{id:"install-파일-설치"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#install-%ED%8C%8C%EC%9D%BC-%EC%84%A4%EC%B9%98",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"install 파일 설치"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"$ sudo .\u002Finstall auto"}]},{type:a,value:c},{type:b,tag:l,props:{id:"codedeploy-agent-상태-확인"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#codedeploy-agent-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"CodeDeploy agent 상태 확인"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"$ sudo service codedeploy-agent status"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"* 연동 설정 파일 추가 및 수정\n   * EC2 에 zip 파일 저장 디렉토리 생성\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"$ mkdir \u002Fhome\u002Fec2-user\u002Fs3\u002Fzip\u002Frest-api"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"* appspec.yml 추가\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:D}]},{type:a,value:c},{type:b,tag:l,props:{id:"codedeploy-에서-전달해준-파일-중-destination-으로-이동시킬-대상-지정"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#codedeploy-%EC%97%90%EC%84%9C-%EC%A0%84%EB%8B%AC%ED%95%B4%EC%A4%80-%ED%8C%8C%EC%9D%BC-%EC%A4%91-destination-%EC%9C%BC%EB%A1%9C-%EC%9D%B4%EB%8F%99%EC%8B%9C%ED%82%AC-%EB%8C%80%EC%83%81-%EC%A7%80%EC%A0%95",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"CodeDeploy 에서 전달해준 파일 중 destination 으로 이동시킬 대상 지정"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"source : \u002F"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:l,props:{id:"source-에서-지정된-파일을-저장할-위치"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#source-%EC%97%90%EC%84%9C-%EC%A7%80%EC%A0%95%EB%90%9C-%ED%8C%8C%EC%9D%BC%EC%9D%84-%EC%A0%80%EC%9E%A5%ED%95%A0-%EC%9C%84%EC%B9%98",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"source 에서 지정된 파일을 저장할 위치"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"destination: \u002Fhome\u002Fec2-user\u002Fs3\u002Fzip\u002Frest-api\u002F"}]},{type:a,value:c},{type:b,tag:l,props:{id:"덮어쓰기-여부"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#%EB%8D%AE%EC%96%B4%EC%93%B0%EA%B8%B0-%EC%97%AC%EB%B6%80",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"덮어쓰기 여부"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"overwrite : yes"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:E}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"deploy:\n..."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"provider: codedeploy\naccess_key_id: $AWS_ACCESS_KEY\nsecret_access_key: $AWS_SECRET_KEY"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"bucket: jimmyberg-rest-api\nkey: rest-api.zip\nbundle_type: zip\napplication: rest-api\ndeployment_group: rest-api-group\nregion: ap-northeast-2\nwait_until_deployed: true"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"* EC2 에 저장된 zip 디렉토리 확인\n\n* **배포 자동화 구성**\n\n* 프로젝트에 deploy.sh 추가\n\n"}]}]}]},{type:a,value:c},{type:b,tag:l,props:{id:"project--scripts--deploysh"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#project--scripts--deploysh",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"project \u003E scripts \u003E deploy.sh"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"#!\u002Fbin\u002Fbash"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"REPOSITORY=\u002Fhome\u002Fec2-user\u002Fapps\nDEPLOY_DIRECTORY=\u002Fhome\u002Fec2-user\u002Fdeploy\nPROJECT_NAME=rest-api"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"echo \"\u003E Build 파일 복사\""}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"cp $DEPLOY_DIRECTORY\u002F$PROJECT_NAME\u002F*.jar $REPOSITORY\u002F$PROJECT_NAME\u002F"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"echo \"\u003E 현재 구동중인 애플리케이션 pid 확인\""}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"CURRENT_PID=$(pgrep -fl $PROJECT_NAME | grep jar | awk '{print $1}')"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"echo \"\u003E 현재 구동 중인 애플리케이션 pid: $CURRENT_PID\""}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"if [ -z \"$CURRENT_PID\" ]; then\necho \"\u003E 현재 구동 중인 애플리케이션이 없으므로 종료하지 않습니다.\"\nelse\necho \"\u003E kill -15 $CURRENT_PID\"\nkill -15 $CURRENT_PID\nsleep 5\nfi"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"echo \"\u003E 새 애플리케이션 배포\""}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"JAR_NAME=$(ls -tr $REPOSITORY\u002F$PROJECT_NAME\u002F*.jar | tail -n 1)"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"echo \"\u003E JAR Name: $JAR_NAME\""}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"echo \"\u003E $JAR_NAME 에 실행권한 추가\""}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"chmod +x $JAR_NAME"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"echo \"\u003E $JAR_NAME 실행\""}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"rm $REPOSITORY\u002F$PROJECT_NAME\u002Fnohup.out"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"nohup java -jar -Dspring.profiles.active=alpha -Dfile.encoding=UTF-8  $JAR_NAME \u003E $REPOSITORY\u002F$PROJECT_NAME\u002Fnohup.out 2\u003E&1 &"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:E}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"language: java\njdk:"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"openjdk8"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"branches:\nonly:\n- master"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"cache:\ndirectories:\n- '$HOME\u002F.m2\u002Frepository'\n- '$HOME\u002F.gradle'"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:z}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:A}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:B}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:C}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"echo $(pwd)"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"mkdir -p before-deploy"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"cp scripts\u002F*.sh before-deploy\u002F"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"cp appspec.yml before-deploy\u002F"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"cp build\u002Flibs\u002F*.jar before-deploy\u002F"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"cd before-deploy && zip -r before-deploy *"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"cd ..\u002F && mkdir -p deploy"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"mv before-deploy\u002Fbefore-deploy.zip deploy\u002Frest-api.zip"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"deploy:"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"provider: s3\naccess_key_id: $AWS_ACCESS_KEY\nsecret_access_key: $AWS_SECRET_KEY\nbucket: jimmyberg-rest-api\nregion: ap-northeast-2\nskip_cleanup: true\nacl: private\nlocal_dir: deploy\nwait-until-deployed: true"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"provider: codedeploy\naccess_key_id: $AWS_ACCESS_KEY\nsecret_access_key: $AWS_SECRET_KEY\nbucket: jimmyberg-rest-api\nkey: rest-api.zip\nbundle_type: zip\napplication: rest-api\ndeployment_group: rest-api-group\nregion: ap-northeast-2\nwait-until-deployed: true"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"notifications:\nslack: [slack accesss key]"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"* appspec.yml 수정\n\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:D}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"source : \u002F\ndestination: \u002Fhome\u002Fec2-user\u002Fdeploy\u002Frest-api\noverwrite : yes"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:l,props:{id:"codedeploy-에서-ec2-로-넘겨준-파일-모두-ec2-user-권한-설정"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#codedeploy-%EC%97%90%EC%84%9C-ec2-%EB%A1%9C-%EB%84%98%EA%B2%A8%EC%A4%80-%ED%8C%8C%EC%9D%BC-%EB%AA%A8%EB%91%90-ec2-user-%EA%B6%8C%ED%95%9C-%EC%84%A4%EC%A0%95",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"CodeDeploy 에서 EC2 로 넘겨준 파일 모두 ec2-user 권한 설정"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"permissions:"}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"object: \u002F\npattern: \"**\"\nowner: ec2-user\ngroup: ec2-user"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:l,props:{id:"codedeploy-배포-단계에서-실행할-명령어-설정"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#codedeploy-%EB%B0%B0%ED%8F%AC-%EB%8B%A8%EA%B3%84%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%ED%95%A0-%EB%AA%85%EB%A0%B9%EC%96%B4-%EC%84%A4%EC%A0%95",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"CodeDeploy 배포 단계에서 실행할 명령어 설정"}]},{type:a,value:c},{type:b,tag:l,props:{id:"applicationstart-단계--ec2-user-권한으로-deploysh-실행"},children:[{type:b,tag:f,props:{ariaHidden:g,href:"#applicationstart-%EB%8B%A8%EA%B3%84--ec2-user-%EA%B6%8C%ED%95%9C%EC%9C%BC%EB%A1%9C-deploysh-%EC%8B%A4%ED%96%89",tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:"ApplicationStart 단계 : ec2-user 권한으로 deploy.sh 실행"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"hooks:\nApplicationStart:\n- location: deploy.sh\ntimeout: 60\nrunas: ec2-user"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"* **배포 Log 확인 방법**\n* CodeDeploy 관련 Log\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"$ cd \u002Fopt\u002Fcodedeploy-agent\u002Fdeploayment-root\u002F\n$ vi .\u002Fdeployment-logs"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"* 프로젝트 관련 Log\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"$ cd ~\u002Fapps\u002Frest-api\u002F\n$ vi .\u002Fnohup.out"}]},{type:a,value:c},{type:b,tag:n,props:{className:[o]},children:[{type:b,tag:p,props:{className:[q,r]},children:[{type:b,tag:s,props:{},children:[{type:a,value:"   ![EC2에 RDS 접근 확인](\u002Fspring-study-week5\u002Fmariadb.png)\n\n\n\n\n"}]}]}]}]},dir:"\u002Farticles",path:"\u002Farticles\u002Fspring-study-week7",extension:".md",createdAt:"2022-01-27T08:34:33.000Z",updatedAt:"2022-03-10T05:16:13.000Z"},prev:{slug:"reactnative-study-week4",title:"Reactnative 스터디 4주차"},next:{slug:"spring-study-week6",title:"EC2 서버에 프로젝트를 배포해 보자"},member:[{slug:"hwikyung",name:t,description:"중앙대학교 GDSC 멤버로 활동하고 있습니다. 백엔드 개발자를 목표로 공부하고 있습니다.",role:"Alumni(21-22 Member)",img:"hwikyung.jpg",dir:"\u002Fmembers",path:"\u002Fmembers\u002Fhwikyung",extension:".yaml",createdAt:"2021-11-26T09:28:42.000Z",updatedAt:"2022-10-26T12:57:45.000Z"}],authorName:t}],fetch:{},mutations:void 0}}("text","element","\n","p","li","a","true",-1,"span","icon","icon-link","h1","ul","div","nuxt-content-highlight","pre","language-text","line-numbers","code","hwikyung kim","스프링-스터디-7주차챕터9","스프링 스터디 7주차(챕터9)","ci--cd-란","CI & CD 란?","h4","before_install:","chmod +x gradlew","script: \".\u002Fgradlew clean build\"","before_deploy:","version: 0.0\nos : linux\nfiles :","* .travis.yml 수정\n\n")));